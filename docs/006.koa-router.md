# Koa Router

최상위 프로젝트 폴더에 [koa-router](https://github.com/ZijianHe/koa-router)를 추가한다.

```bash
yarn add koa-router
```

## 서버

`routes` 폴더를 만들고 `index.js`와 `api.js`를 추가한다.

```js
mkdir routes
cd routes
touch index.js
```

### index.js

```js
const Router = require('koa-router');
const router = new Router();

const api = require('./api');

router.use(api.routes());
router.use(api.allowedMethods());

module.exports = router;
```

### api.js

```js
const Router = require('koa-router');
const router = new Router({
  prefix: '/api'
});

// responds to "/api"
router.get('/hello', (ctx, next) => {
  ctx.body = {
    greet: "Hello, there."
  };
});

module.exports = router;
```

### app.js

`app.js`에 `routes` 모듈을 추가한다.

```js
const Koa = require('koa');
const serve = require('koa-static');
const app = new Koa();

app.use(serve(__dirname + '/client/build'));

const router = require('./routes');

app.use(router.routes());
app.use(router.allowedMethods());

module.exports = app;
```

## 클라이언트

```js
import React, { useState, useEffect } from 'react';

function App() {

  const [message, setMessage] = useState('');

  useEffect(() => {
    fetch('/api/hello')
      .then((response) => response.json())
      .then((json) => {
        setMessage(json.greet);
      })
      .catch((error) => {
        console.error(error);
      });
  });

  return (
    <div className="App">
      {message}
    </div>
  );
}

export default App;
```
